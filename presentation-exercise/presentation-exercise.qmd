---
title: "Presentation Exercise"
---

For this exercise, I will find publicly available data from news sources and try to replicate one of their figures or tables.

# Weâ€™ve Never Seen Congressional Resignations Like This Before

This article from ABC News 538 discusses trends in the reasons behind members of congress' resignations, and can be found at the following [link]('https://fivethirtyeight.com/features/more-people-are-resigning-from-congress-than-at-any-time-in-recent-history/'). The figure from this article I have chosen to replicate is shown below: ![figure](Congressional_Resignations.png)

The figure is a stacked bar graph showing the distribution of reasons for congressional resignations in each term from the 57th Congress to the 115th Congress in years ranging from 1901 to 2018.

```{r}
#Load required packages
library(here)
library(ggplot2)
library(tidyverse)
```

```{r}
#Load data
data_path <- here("presentation-exercise", "congressional_resignations.csv")
data <- read_csv(data_path)

#Get data structure and summary
str(data)
summary(data)
```

The following code for reproducing the figure was generated by ChatGPT following the prompt, "Using the data in the attached csv file, write code in R to reproduce the attached graph." A png screenshot of the figure and the data in a csv file were provided as input along with the prompt.

```{r}
df <- data

# Convert Congress to numeric
df$Congress <- as.numeric(gsub("th|rd|nd|st", "", df$Congress))

# Define category color mapping
category_colors <- c(
  "OTHER OFFICE" = "#FFC72C",
  "PRIVATE SECTOR" = "#007CC3",
  "EARLY DEPARTURE" = "#8B5E83",
  "SEXUAL MISCONDUCT" = "#E81D2C",
  "ELECTION OVERTURNED" = "#1D1D1D",
  "HEALTH/FAMILY" = "#509E2F",
  "MILITARY SERVICE" = "#A05A2C",
  "CONSENSUAL SEX SCANDALS" = "#FFB6C1",
  "OTHER SCANDAL" = "#D3D3D3",
  "OTHER REASON" = "#BEBEBE"
)

# Aggregate data for plotting
df_plot <- df %>%
  count(Congress, Category) %>%
  filter(!is.na(Congress))

# Create stacked bar plot
ggplot(df_plot, aes(x = Congress, y = n, fill = Category)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = category_colors) +
  labs(
    title = "Congressional resignations over time",
    subtitle = "Number of congressional resignations by session and public reason for resignation since 1901",
    x = "Congress",
    y = "Number of Resignations",
    fill = "Reason"
  ) +
  theme_minimal()

```

The bars themselves are correct, but many other elements are missing. The colors aren't there, the theme doesn't match the original, and there's no legend.

```{r}
#Separate rows with multiple reported reasons for resignation
df <- df %>%
  separate_rows(Category, sep = " & ") %>%
  mutate(across(where(is.character), str_trim))

# Define category code mapping
df <- df %>%
  mutate(Category = case_when(
    Category == "X" ~ "Sexual misconduct",
    Category == "A" ~ "Consensual sex scandals",
    Category == "B" ~ "Other scandal",
    Category == "C" ~ "Other office",
    Category == "D" ~ "Private sector",
    Category == "E" ~ "Health/family",
    Category == "F" ~ "Other reason",
    Category == "G" ~ "Early departure",
    Category == "H" ~ "Military service",
    Category == "I" ~ "Election overturned",
    TRUE ~ NA_character_
  ))

#Define category color mapping
category_colors <- c(
  "Other office" = "#F5B902",
  "Election overturned" = "#1D1D1D",
  "Private sector" = "#038FD5",  
  "Health/family" = "#44AB43",
  "Early departure" = "#AE66AB",  
  "Military service" = "#A4522E",
  "Sexual misconduct" = "#E81D2C",
  "Consensual sex scandals" = "#FFB6C1",
  "Other scandal" = "#FFE3D7",
  "Other reason" = "#BEBEBE"
)

#Ensure stacking order in the correct sequence
df$Category <- factor(df$Category, levels = names(category_colors))


#Aggregate data for plotting
df_plot <- df %>%
  count(Congress, Category) %>%
  filter(!is.na(Congress))

#Replot
ggplot(df_plot, aes(x = Congress, y = n, fill = Category)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = category_colors) +
  labs(
    title = "Congressional resignations over time",
    subtitle = "Number of congressional resignations by session and public reason for resignation since 1901",
    x = "Congress",
    y = "Number of Resignations",
    fill = "Category"
  ) +
  theme_minimal()

```
